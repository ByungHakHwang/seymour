\documentclass{article}

\usepackage{amsmath} % Matrices, etc.
\usepackage{amssymb} % \mathbb, etc.

\usepackage{amsthm} % Theorem environments

\usepackage{hyperref} % Clickable links

\newtheorem{lemma}{Lemma}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{corollary}{Corollary}
\newtheorem{remark}{Remark}

\usepackage[margin=2.5cm]{geometry} % Page margins

\usepackage{graphicx} % Inserting images
\usepackage{nicematrix} % Typesetting advanced matrices % Manual: https://mirror.kumi.systems/ctan/macros/latex/contrib/nicematrix/nicematrix.pdf
\usepackage{todonotes} % Todos

% Header
\title{Proof of Regularity of 2- and 3-Sum of Matroids}
\author{Ivan Sergeev}
\date{March--April 2025}

\begin{document}

\maketitle

\section{2-Sum of Regular Matroids Is Regular}

\begin{lemma}\label{lem:pivot_submatrix_det}
    Let $A$ be a $k \times k$ matrix. Let $r, c \in \{1, \dots, k\}$ be a row and column index, respectively, such that $a_{rc} \neq 0$. Let $A'$ denote the matrix obtained from $A$ by performing a real pivot on $a_{rc}$. Then there exists a $(k - 1) \times (k - 1)$ submatrix $A''$ of $A'$ with $|\det A''| = \frac{|\det A|}{|a_{rc}|}$.
\end{lemma}

\begin{proof}
    Let $A''$ be the submatrix of $A'$ given by row index set $R = \{1, \dots, k\} \setminus \{r\}$ and column index set $C = \{1, \dots, k\} \setminus \{c\}$. By the explicit formula for pivoting in $A$ on $a_{rc}$, the entries of $A''$ are given by $a_{ij}'' = a_{ij} - \frac{a_{ic} a_{rj}}{a_{rc}}$. Using the linearity of the determinant, we can express $\det A''$ as
    \[
        \det A'' = \det A' - \sum_{k \in C} \frac{a_{rk}}{a_{rc}} \det B_{k}''
    \]
    where $B_{k}''$ is a matrix obtained from $A''$ by replacing column $a_{\cdot k}''$ with the pivot column $a_{\cdot c}$ without the pivot element $a_{rc}$.

    By the cofactor expansion in $A$ along row $r$, we have
    \[
        \det A = \sum_{k = 1}^{n} (-1)^{r + k} a_{rk} \det B_{r, k}
    \]
    where $B_{r, k}$ is obtained from $A$ by removing row $r$ and column $k$. By swapping the order of columns in $B_{r, k}$ to match the form of $B_{k}$, we get
    \[
        \det A = (-1)^{r + c} (a_{rc} \det A' - \sum_{k \in C} a_{rk} \det B_{k}'').
    \]

    By combining the above results, we get $|\det A''| = \frac{|\det A|}{|a_{rc}|}$.
\end{proof}

\begin{corollary}\label{cor:pivot_submatrix_det}
    Let $A$ be a $k \times k$ matrix with $\det A \notin \{0, \pm 1\}$. Let $r, c \in \{1, \dots, k\}$ be a row and column index, respectively, and suppose that $a_{rc} \in \{\pm 1\}$. Let $A'$ denote the matrix obtained from $A$ by performing a real pivot on $a_{rc}$. Then there exists a $(k - 1) \times (k - 1)$ submatrix $A''$ of $A'$ with $\det A'' \notin \{0, \pm 1\}$.
\end{corollary}

\begin{proof}
    Since $a_{rc} \in \{\pm 1\}$, by Lemma~\ref{lem:pivot_submatrix_det} there exists a $(k - 1) \times (k - 1)$ submatrix $A''$ with $|\det A| = |\det A''|$. Since $\det A \notin \{0, \pm 1\}$, we have $\det A'' \notin \{0, \pm 1\}$.
\end{proof}

\begin{definition}\label{def:two_sum}
    Let $B_{1}, B_{2}$ be matrices with $\{0, \pm 1\}$ entries expressed as $B_{1} = \left[A_{1} / x\right]$ and $B_{2} = \left[y \mid A_{2}\right]$, where $x$ is a row vector, $y$ is a column vector, and $A_{1}, A_{2}$ are matrices of appropriate dimensions. Let $D$ be the outer product of $y$ and $x$. The $2$-sum of $B_{1}$ and $B_{2}$ is defined as
    \[
        B_{1} \oplus_{2, x, y} B_{2} = \begin{bmatrix}
            A_{1} & 0 \\
            D & A_{2} \\
        \end{bmatrix}.
    \]
\end{definition}

\begin{definition}\label{def:k_tu}
    Given $k \in \mathbb{Z}_{\geq 1}$, we say that a matrix $A$ is $k$-TU if every square submatrix of $A$ of size $k$ has determinant in $\{0, \pm 1\}$.
\end{definition}

\begin{remark}
    Note that a matrix is TU if and only if it is $k$-TU for every $k \in \mathbb{Z}_{\geq 1}$.
\end{remark}

\begin{lemma}\label{lem:two_sum_1_2_tu}
    Let $B_{1}$ and $B_{2}$ be TU matrices and let $B = B_{1} \oplus_{2, x, y} B_{2}$. Then $B$ is $1$-TU and $2$-TU.
\end{lemma}

\begin{proof}
    To see that $B$ is $1$-TU, note that $B$ is a $\{0, \pm 1\}$ matrix by construction.

    To show that $B$ is $2$-TU, let $V$ be a $2 \times 2$ submatrix $V$ of $B$. If $V$ is a submatrix of $\left[A_{1} / D\right]$, $\left[D \mid A_{2}\right]$, $\left[A_{1} \mid 0\right]$, or $\left[0 / A_{2}\right]$, then $\det V \in \{0, \pm 1\}$, as all of those four matrices are TU. Otherwise $V$ shares exactly one row and one column index with both $A_{1}$ and $A_{2}$. Let $i$ be the row shared by $V$ and $A_{1}$ and $j$ be the column shared by $V$ and $A_{2}$. Note that $V_{ij} = 0$. Thus, up to sign, $\det V$ equals the product of the entries on the diagonal not containing $V_{ij}$. Since both of those entries are in $\{0, \pm 1\}$, we have $\det V \in \{0, \pm 1\}$.
\end{proof}

\begin{lemma}\label{lem:two_sum_k_tu_induction}
    Let $k \in \mathbb{Z}_{\geq 1}$. Suppose that for any TU matrices $B_{1}$ and $B_{2}$ their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is $\ell$-TU for every $\ell < k$. Then for any TU matrices $B_{1}$ and $B_{2}$ their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is also $k$-TU.
\end{lemma}

\begin{proof}
    For the sake of deriving a contradiction, suppose there exist TU matrices $B_{1}$ and $B_{2}$ such that their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is not $k$-TU. Then $B$ contains a $k \times k$ submatrix $V$ with $\det V \notin \{0, \pm 1\}$.

    Note that $V$ cannot be a submatrix of $\left[A_{1} / D\right]$, $\left[D \mid A_{2}\right]$, $\left[A_{1} \mid 0\right]$, or $\left[0 / A_{2}\right]$, as all of those four matrices are TU. Thus, $V$ shares at least one row and one column index with $A_{1}$ and $A_{2}$ each.

    Consider the row of $V$ whose index appears in $A_{1}$. Note that it cannot consist of only $0$ entries, as otherwise $\det V = 0$. Thus there exists a $\pm 1$ entry shared by $V$ and $A_{1}$. Let $r$ and $c$ denote the row and column index of this entry, respectively.

    Perform a rational pivot in $B$ on the element $B_{rc}$. For every object, its modified counterpart after pivoting is denoted by the same symbol with an added tilde; for example, $\tilde{B}$ denotes the entire matrix after the pivot. Note that after pivoting the following statements hold:
    \begin{itemize}
        \item $\left[\tilde{A}_{1} / \tilde{D}\right]$ is TU, since TUness is preserved by pivoting.
        \item $\tilde{A}_{2} = A_{2}$, i.e., $A_{2}$ remains unchanged. This holds because of the $0$ block in $B$.
        \item $\tilde{D}$ consists of copies of $y$ scaled by factors in $\{0, \pm 1\}$. This can be verified via a case distinction and a simple calculation.
        \item $\left[\tilde{D} \mid \tilde{A}_{2}\right]$ is TU, since this matrix consists of $A_{2}$ and copies of $y$ scaled by factors $\{0, \pm 1\}$.
        \item $\tilde{D}$ can be represented as an outer product of a column vector $\tilde{y}$ and a row vector $\tilde{x}$, and we can define $\tilde{B}_{1} = \left[\tilde{A}_{1} / \tilde{x}\right]$ and $\tilde{B}_{2} = \left[\tilde{y} \mid \tilde{A}_{2}\right]$ similar to $B_{1}$ and $B_{2}$, respectively. Note that $\tilde{B}_{1}$ and $\tilde{B}_{2}$ have the same size as $B_{1}$ and $B_{2}$, respectively, are both TU, and satisfy $\tilde{B} = \tilde{B}_{1} \oplus_{2, \tilde{x}, \tilde{y}} \tilde{B}_{2}$.
        \item $\tilde{B}$ contains a square submatrix $\tilde{V}$ of size $k - 1$ with $\det \tilde{V} \notin \{0, \pm 1\}$. Indeed, by Corollary~\ref{cor:pivot_submatrix_det} from Lemma~\ref{lem:pivot_submatrix_det}, pivoting in $V$ on the element $B_{rc}$ results in a matrix containing a $(k - 1) \times (k - 1)$ submatrix $V''$ with $\det V'' \in \{0, \pm 1\}$. Since $V$ is a submatrix of $B$, the submatrix $V''$ corresponds to a submatrix $\tilde{V}$ of $\tilde{B}$ with the same property.
    \end{itemize}
    To sum up, after pivoting we obtain a matrix $\tilde{B}$ that represents a $2$-sum of TU matrices $\tilde{B}_{1}$ and $\tilde{B}_{2}$ and contains a square submatrix of size $k - 1$ with determinant not in $\{0, \pm 1\}$. This is a contradiction with $(k - 1)$-TUness of $\tilde{B}$, which proves the lemma.
\end{proof}

\begin{lemma}\label{lem:two_sum_tu}
    Let $B_{1}$ and $B_{2}$ be TU matrices. Then $B_{1} \oplus_{2, x, y} B_{2}$ is also TU.
\end{lemma}

\begin{proof}
    Proof by induction.

    Proposition for any $k \in \mathbb{Z}_{\geq 1}$: For any TU matrices $B_{1}$ and $B_{2}$, their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is $\ell$-TU for every $\ell \leq k$.

    Base: The Proposition holds for $k = 1$ and $k = 2$ by Lemma~\ref{lem:two_sum_1_2_tu}.

    Step: If the Proposition holds for some $k$, then it also holds for $k + 1$ by Lemma~\ref{lem:two_sum_k_tu_induction}.

    Conclusion: For any TU matrices $B_{1}$ and $B_{2}$, their $2$-sum $B_{1} \oplus_{2, x, y} B_{2}$ is $k$-TU for every $k \in \mathbb{Z}_{\geq 1}$. Thus, $B_{1} \oplus_{2, x, y} B_{2}$ is TU.
\end{proof}

\newpage
\section{3-Sum of Regular Matroids Is Regular}

\subsection{Definition of 3-Sum}

\begin{definition}\label{def:three_sum}
    Let $B_{1}^{(0)} \in \mathbb{Z}_{2}^{(X_{1} \cup \{x_{0}, x_{1}\}) \times (Y_{1} \cup \{y_{2}\})}, B_{2}^{(0)} \in \mathbb{Z}_{2}^{(X_{2} \cup \{x_{2}\}) \times (Y_{2} \cup \{y_{0}, y_{1}\})}$ be matrices of the form
    \[
        B_{1}^{(0)} =
        \begin{NiceArray}{ccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}^{(0)}} & & & & \Block[draw]{4-1}{0} \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}^{(0)}} & & \Block[draw]{2-2}{D_{0}^{(0)}} & & \Block[draw]{1-1}{1} \\
             & & & & \Block[draw]{1-1}{1} \\
        \end{NiceArray}
        , \quad
        B_{2}^{(0)} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{2-2}{D_{0}^{(0)}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}^{(0)}} \\
             & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{2}^{(0)}} \\
            \\
        \end{NiceArray},
    \]
    where $D_{0}^{(0)} (x_{0}, y_{0}) = 1$, $D_{0}^{(0)} (x_{0}, y_{1}) \in \{0, 1\}$, $D_{0}^{(0)} (x_{1}, y_{0}) = 0$, and $D_{0}^{(0)} (x_{1}, y_{1}) = 1$. Let $D_{12}^{(0)} = D_{2}^{(0)} \cdot (D_{0}^{(0)})^{-1} \cdot D_{1}^{(0)}$ (note that $D_{0}^{(0)}$ is invertible by construction). Then the $3$-sum of $B_{1}^{(0)}$ and $B_{2}^{(0)}$ is
    \[
        B^{(0)} = B_{1}^{(0)} \oplus_{3} B_{2}^{(0)} =
        \begin{NiceArray}{cccccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}^{(0)}} & & & & \Block[draw]{4-4}{0} & & & \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}^{(0)}} & & \Block[draw]{2-2}{D_{0}^{(0)}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}^{(0)}} \\
             & & & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{12}^{(0)}} & & \Block[draw]{2-2}{D_{2}^{(0)}} \\
            \\
        \end{NiceArray} \in \mathbb{Z}_{2}^{(X_{1} \cup X_{2}) \times (Y_{1} \cup Y_{2})}.
    \]
    Here $x_{2} \in X_{1}$, $x_{0}, x_{1} \in X_{2}$, $y_{0}, y_{1} \in Y_{1}$, $y_{2} \in Y_{2}$, $A_{1}^{(0)} \in \mathbb{Z}_{2}^{X_{1} \times Y_{1}}$, $A_{2}^{(0)} \in \mathbb{Z}_{2}^{X_{2} \times Y_{2}}$, $D_{1}^{(0)} \in \mathbb{Z}_{2}^{\{x_{0}, x_{1}\} \times (Y_{1} \setminus \{y_{0}, y_{1}\})}$, $D_{2}^{(0)} \in \mathbb{Z}_{2}^{(X_{2} \setminus \{x_{0}, x_{1}\}) \times \{y_{0}, y_{1}\}}$, $D_{0}^{(0)} \in \mathbb{Z}_{2}^{\{x_{0}, x_{1}\} \times \{y_{0}, y_{1}\}}$, $D_{12}^{(0)} \in \mathbb{Z}_{2}^{(X_{2} \setminus \{x_{0}, x_{1}\}) \times (Y_{1} \setminus \{y_{0}, y_{1}\})}$. The indexing is kept consistent between $B_{1}^{(0)}$, $B_{2}^{(0)}$, and $B^{(0)}$. To simplify notation, we use the following shorthands:
    \[
        D_{1, 12}^{(0)} = \begin{NiceArray}{c}[hvlines] D_{1}^{(0)} \\ D_{12}^{(0)} \\ \end{NiceArray}, \quad
        D_{0, 2}^{(0)} = \begin{NiceArray}{c}[hvlines] D_{0}^{(0)} \\ D_{2}^{(0)} \\ \end{NiceArray}, \quad
        D_{1, 0}^{(0)} = \begin{NiceArray}{cc}[hvlines] D_{1}^{(0)} & D_{0}^{(0)} \\ \end{NiceArray}, \quad
        D_{12, 2}^{(0)} = \begin{NiceArray}{cc}[hvlines] D_{12}^{(0)} & D_{2}^{(0)} \\ \end{NiceArray}, \quad
        D^{(0)} = \begin{NiceArray}{cc}[hvlines] D_{1}^{(0)} & D_{0}^{(0)} \\ D_{12}^{(0)} & D_{2}^{(0)} \\ \end{NiceArray}.
    \]
\end{definition}

The following lemma justifies the additional assumption on the entries of $D_{0}^{(0)}$.\todo{can omit}

\begin{lemma}\label{lem:matrix_z2_2_2_rank_2}
    Let $D_{0}^{(0)} \in \mathbb{Z}_{2}^{2 \times 2}$ be non-singular. Then (up to row and column indices)
    \[
        D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}
        \quad \text{or} \quad
        D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}
    \]
\end{lemma}

\begin{proof}
    Verify by complete enumeration.\todo{need details?}
\end{proof}

\subsection{Construction of Canonical Signing}

\begin{definition}\label{def:three_sum_canonical_signing}
    We call $B_{1}$ and $B_{2}$ canonical signings of $B_{1}^{(0)}$ and $B_{2}^{(0)}$, respectively, if they have the form
    \[
        B_{1} =
        \begin{NiceArray}{ccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}} & & & & \Block[draw]{4-1}{0} \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}} & & \Block[draw]{2-2}{D_{0}} & & \Block[draw]{1-1}{1} \\
             & & & & \Block[draw]{1-1}{1} \\
        \end{NiceArray}
        , \quad
        B_{2} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{2-2}{D_{0}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}} \\
             & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{2}} \\
            \\
        \end{NiceArray}
    \]
    where every block in $B_{1}$ and $B_{2}$ is a signing of the corresponding block in $B_{1}^{(0)}$ and $B_{2}^{(0)}$, and $D_{0}$ is the canonical signing of $D_{0}^{(0)}$, which is defined as follows:
    \[
        \text{if } D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}
        \text{ then } D_{0} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & -1 \\ \end{NiceArray}, \quad
        \text{if } D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}
        \text{ then } D_{0} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}.
    \]
    Given canonical signings $B_{1}$ and $B_{2}$, the corresponding canonical signing of $B^{(0)}$ is defined as
    \[
        B =
        \begin{NiceArray}{cccccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}} & & & & \Block[draw]{4-4}{0} & & & \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}} & & \Block[draw]{2-2}{D_{0}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}} \\
             & & & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{12}} & & \Block[draw]{2-2}{D_{2}} \\
            \\
        \end{NiceArray}
    \]
    where $D_{12} = D_{2} \cdot (D_{0})^{-1} \cdot D_{1}$. (Note that $(D_{0})^{-1}$ is over $\mathbb{Q}$.)
\end{definition}

The following lemma helps construct canonical signings from arbitrary initial TU signings.

\begin{lemma}\label{lem:three_sum_canonical_resigning_helper}
    Let $Q'$ be a TU signing of the matrix
    \[
        T = \begin{NiceArray}{ccc}[hvlines]
            1 & 1 & 0 \\
            \Block[draw]{2-2}{D_{0}^{(0)}} & & 1 \\
             & & 1 \\
        \end{NiceArray} \in \mathbb{Z}_{2}^{(x_{0}, x_{1}, x_{2}) \times (y_{0}, y_{1}, y_{2})}
    \]
    where $D_{0}^{(0)} (x_{0}, y_{0}) = 1$, $D_{0}^{(0)} (x_{0}, y_{1}) \in \{0, 1\}$, $D_{0}^{(0)} (x_{1}, y_{0}) = 0$, and $D_{0}^{(0)} (x_{1}, y_{1}) = 1$. Define $u \in \{0, \pm 1\}^{\{x_{0}, x_{1}, x_{2}\}}$, $v \in \{0, \pm 1\}^{\{y_{0}, y_{1}, y_{2}\}}$, and $Q$ as follows:
    \begin{gather*}
        u(x_{0}) = Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}), \quad
        u(x_{1}) = Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}) \cdot Q' (x_{1}, y_{2}), \quad
        u(x_{2}) = 1, \\
        v(y_{0}) = Q' (x_{2}, y_{0}), \quad
        v(y_{1}) = Q' (x_{2}, y_{1}), \quad
        v(y_{2}) = Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}), \\
        \forall i \in \{x_{0}, x_{1}, x_{2}\}, \ \forall j \in \{y_{0}, y_{1}, y_{2}\}, \quad Q (i, j) = Q' (i, j) \cdot u(i) \cdot v(j).
    \end{gather*}
    Then $Q$ is a TU signing of $T$ and $Q = \begin{NiceArray}{ccc}[hvlines] 1 & 1 & 0 \\ \Block[draw]{2-2}{D_{0}} & & 1 \\ & & 1 \\ \end{NiceArray}$ where $D_{0}$ is the respective canonical signing of $D_{0}^{(0)}$.
\end{lemma}

\begin{proof}
    Since $Q'$ is a TU signing of $T$ and $Q$ is obtained from $Q'$ by multiplying rows and columns by $\pm 1$ factors, $Q$ is also a TU signing of $T$. By construction, we have
    \begin{align*}
        Q (x_{2}, y_{0}) &= Q' (x_{2}, y_{0}) \cdot 1 \cdot Q' (x_{2}, y_{0}) = 1, \\
        Q (x_{2}, y_{1}) &= Q' (x_{2}, y_{1}) \cdot 1 \cdot Q' (x_{2}, y_{1}) = 1, \\
        Q (x_{2}, y_{2}) &= 0, \\
        Q (x_{0}, y_{0}) &= Q' (x_{0}, y_{0}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0})) \cdot Q' (x_{2}, y_{0}) = 1, \\
        Q (x_{0}, y_{1}) &= Q' (x_{0}, y_{1}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0})) \cdot Q' (x_{2}, y_{1}), \\
        Q (x_{0}, y_{2}) &= Q' (x_{0}, y_{2}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0})) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2})) = 1, \\
        Q (x_{1}, y_{0}) &= 0, \\
        Q (x_{1}, y_{1}) &= Q' (x_{1}, y_{1}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}) \cdot Q' (x_{1}, y_{2})) \cdot (Q' (x_{2}, y_{1})), \\
        Q (x_{1}, y_{2}) &= Q' (x_{1}, y_{2}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}) \cdot Q' (x_{1}, y_{2})) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2})) = 1.
    \end{align*}
    Thus, it remains to check that $Q (x_{0}, y_{1})$ and $Q (x_{1}, y_{1})$ are correct.

    First, consider the entry $Q (x_{0}, y_{1})$. If $D_{0}^{(0)} (x_{0}, y_{1}) = 0$, then $Q (x_{0}, y_{1}) = 0$, as needed. Otherwise, if $D_{0}^{(0)} (x_{0}, y_{1}) = 1$, then $Q (x_{0}, y_{1}) \in \{\pm 1\}$, as $Q$ is a signing of $T$. Our goal is to show that $Q (x_{0}, y_{1}) = 1$. For the sake of deriving a contradiction suppose that $Q (x_{0}, y_{1}) = -1$. Then the determinant of the submatrix of $Q$ indexed by $\{x_{0}, x_{2}\} \times \{y_{0}, y_{1}\}$ is
    \[
        \det \begin{NiceArray}{cc}[hvlines] 1 & -1 \\ 1 & 1 \\ \end{NiceArray} = 2 \notin \{0, \pm 1\},
    \]
    which contradicts TUness of $Q$. Thus, $Q (x_{0}, y_{1}) = 1$, as needed.

    Consider the entry $Q (x_{1}, y_{1})$. Since $Q$ is a signing of $T$, we have $Q (x_{1}, y_{1}) \in \{\pm 1\}$. Note that we know all the other entries of $Q$, so we can determine the sign of $Q (x_{1}, y_{1})$ using TUness of $Q$. Consider two cases.
    \begin{enumerate}
        \item Suppose that $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}$. If $Q (x_{1}, y_{1}) = 1$, then
        $
            \det Q = \det \begin{NiceArray}{ccc}[hvlines]
                1 & 1 & 0 \\
                1 & 0 & 1 \\
                0 & 1 & 1 \\
            \end{NiceArray} = -2 \notin \{0, \pm 1\},
        $
        which contradicts TUness of $Q$. Thus, $Q (x_{1}, y_{1}) = -1$, as needed.
        \item Suppose that $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}$. If $Q (x_{1}, y_{1}) = -1$, then
        $
            \det Q = \det \begin{NiceArray}{ccc}[hvlines]
                1 & 1 & 0 \\
                1 & 1 & 1 \\
                0 & -1 & 1 \\
            \end{NiceArray} = 2 \notin \{0, \pm 1\},
        $
        which contradicts TUness of $Q$. Thus, $Q (x_{1}, y_{1}) = 1$, as needed.
    \end{enumerate}
\end{proof}

\begin{definition}\label{def:three_sum_canonical_resigning}
    Let $X$ and $Y$ be sets with $\{x_{0}, x_{1}, x_{2}\} \subseteq X$ and $\{y_{0}, y_{1}, y_{2}\} \subseteq Y$. Let $Q' \in \mathbb{Q}^{X \times Y}$ be a TU signing of $Q^{(0)} \in \mathbb{Z}_{2}^{X \times Y}$. Let $u \in \{0, \pm 1\}^{X}$, $v \in \{0, \pm 1\}^{Y}$, and $Q$ be constructed as follows:
    \begin{gather*}
        u(i) = \begin{cases}
            Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}), & i = x_{0}, \\
            Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}) \cdot Q' (x_{1}, y_{2}), & i = x_{1}, \\
            1, & i = x_{2}, \\
            1, & i \in X \setminus \{x_{0}, x_{1}, x_{2}\},
        \end{cases} \\
        v(j) = \begin{cases}
            Q' (x_{2}, y_{0}), & j = y_{0}, \\
            Q' (x_{2}, y_{1}), & j = y_{1}, \\
            Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}), & j = y_{2}, \\
            1, & j \in Y \setminus \{y_{0}, y_{1}, y_{2}\}, \\
        \end{cases} \\
        \forall i \in X, \ \forall j \in Y, \quad Q (i, j) = Q' (i, j) \cdot u(i) \cdot v(j).
    \end{gather*}
    We call $Q$ a canonical resigning of $Q'$.
\end{definition}

\begin{lemma}\label{lem:three_sum_canonical_signing_construction}
    Let $B_{1}'$ be a TU signing of $B_{1}^{(0)}$. Let $B_{1}$ be the canonical resigning (constructed following Definition~\ref{def:three_sum_canonical_resigning}) of $B_{1}'$. Then $B_{1}$ is a canonical signing of $B_{1}^{(0)}$ (in the sense of Definition~\ref{def:three_sum_canonical_signing}) and $B_{1}$ is TU. Going forward, we refer to $B_{1}$ as a TU canonical signing for short of $B_{1}^{(0)}$. A TU canonical signing $B_{2}$ of $B_{2}^{(0)}$ is defined similarly (up to replacing subscripts 1 by 2).
\end{lemma}

\begin{proof}
    This follows directly from Lemma~\ref{lem:three_sum_canonical_resigning_helper}.
\end{proof}

\begin{lemma}\label{lem:three_sum_A_2_ext_1_TU}
    Let $B_{2}$ be a TU canonical signing of $B_{2}^{(0)}$. Let $c_{0} = (D_{0, 2})_{\cdot, y_{0}}$ and $c_{1} = (D_{0, 2})_{\cdot, y_{1}}$. Then the following matrices are TU:
    \[
        B_{2}^{(a)} = [c_{0} - c_{1} \mid c_{0} \mid A_{2}], \quad
        B_{2}^{(b)} = [c_{0} - c_{1} \mid c_{1} \mid A_{2}].
    \]
\end{lemma}

\begin{proof}
    Pivoting in $B_{2}$ on $(x_{2}, y_{0})$ and $(x_{2}, y_{1})$ yields:
    \[
        B_{2} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{c_{0}} & \Block[draw]{4-1}{c_{1}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \CodeAfter
            \tikz \draw (1-1) circle (0.2);
        \end{NiceArray}
        \quad \to \quad
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{-c_{0}} & \Block[draw]{4-1}{c_{1} - c_{0}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \end{NiceArray}
    \]
    \[
        B_{2} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{c_{0}} & \Block[draw]{4-1}{c_{1}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \CodeAfter
            \tikz \draw (1-2) circle (0.2);
        \end{NiceArray}
        \quad \to \quad
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{c_{0} - c_{1}} & \Block[draw]{4-1}{-c_{1}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \end{NiceArray}
    \]
    By removing row $x_{2}$ from the resulting matrices and then multiplying columns $y_{0}$ and $y_{1}$ by $\{\pm 1\}$ factors, we obtain $B_{2}^{(a)}$ and $B_{2}^{(b)}$. By Lemma~\ref{lem:three_sum_canonical_signing_construction}, $B_{2}$ is TU. Since TUness is preserved under pivoting, taking submatrices, and multiplying columns by ${\pm 1}$ factors, we conclude that $B_{2}^{(a)}$ and $B_{2}^{(b)}$ are TU.
\end{proof}

\begin{lemma}\label{lem:three_sum_A_2_ext_2_TU}
    Let $B_{2}$ be a TU canonical signing of $B_{2}^{(0)}$. Let $c_{0} = D_{0, 2} (\cdot, y_{0})$, $c_{1} = D_{0, 2} (\cdot, y_{1})$, and $c_{2} = c_{0} - c_{1}$. Then the following properties hold.
    \begin{enumerate}
        \item\label{item:three_sum_A_2_ext_d01_eq} For every $i \in X_{2}$, we have $[c_{0} (i) \mid c_{1} (i)] \in \{0, \pm 1\}^{\{y_{0}, y_{1}\}} \setminus \{[1 \mid -1] , [-1 \mid 1]\}$.
        % \item\label{item:three_sum_A_2_ext_2_vec_sign} $c_{2}$ is a signing of $D_{0, 2}^{(0)} (\cdot, y_{0}) + D_{0, 2}^{(0)} (\cdot, y_{1})$.
        \item\label{item:three_sum_A_2_ext_2_TU} $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$ is TU.
    \end{enumerate}
\end{lemma}

\begin{proof}
    \begin{enumerate}
        \item Let $i \in X_{2}$. If $[c_{0} (i) \mid c_{1} (i)] = [1 \mid -1]$, then the $2 \times 2$ submatrix of $B_{2}$ indexed by $\{x_{2}, i\} \times \{y_{0}, y_{1}\}$ has $\det \begin{bmatrix} 1 & 1 \\ 1 & -1 \\ \end{bmatrix} = -2 \notin \{0, \pm 1\}$, which contradicts TUness of $B_{2}$ (which holds by Lemma~\ref{lem:three_sum_canonical_signing_construction}). Similarly, if $[c_{0} (i) \mid c_{1} (i)] = [-1 \mid 1]$, then the $2 \times 2$ submatrix of $B_{2}$ indexed by $\{x_{2}, i\} \times \{y_{0}, y_{1}\}$ has $\det \begin{bmatrix} 1 & 1 \\ -1 & 1 \\ \end{bmatrix} = 2 \notin \{0, \pm 1\}$, which contradicts TUness of $B_{2}$.

        % \item By item~\ref{item:three_sum_A_2_ext_d01_eq}, we know that $[c_{0} (i) \mid c_{1} (i)] \neq [1 \mid -1]$ and $[c_{0} (i) \mid c_{1} (i)] \neq [-1 \mid 1]$. In all other cases, a direct calculation shows that $c_{2} (i) \in \{0, \pm 1\}$ and $|c_{2}(i)| = D_{0, 2}^{(0)} (\cdot, y_{0}) + D_{0, 2}^{(0)} (\cdot, y_{1})$.

        \item Let $V$ be a square submatrix of $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$. We will show that $\det V \in \{0, \pm 1\}$.

        Let $z$ denote the index of the appended column $c_{2}$. Suppose that column $z$ is not in $V$. Then $V$ is a submatrix of $B_{2}$, which is TU by Lemma~\ref{lem:three_sum_canonical_signing_construction}. Thus, $\det V \in \{0, \pm 1\}$. Going forward we assume that column $z$ is in $V$.

        Suppose that columns $y_{0}$ and $y_{1}$ are both in $V$. Then $V$ contains columns $z$, $y_{0}$, and $y_{1}$, which are linearly dependent by construction of $c_{2}$. Thus, $\det V = 0$. Going forward we assume that at most one of the columns $y_{0}$ and $y_{2}$ is in $V$.

        Suppose that column $y_{0}$ is in $V$. Then $V$ is a submatrix of $B_{2}^{(b)}$ from Lemma~\ref{lem:three_sum_A_2_ext_1_TU}, and thus $\det V \in \{0, \pm 1\}$. Otherwise, $V$ is a submatrix of $B_{2}^{(a)}$ from Lemma~\ref{lem:three_sum_A_2_ext_1_TU}, and so $\det V \in \{0, \pm 1\}$.

        Thus, every square submatrix $V$ of $\tilde{T}$ has $\det V \in \{0, \pm 1\}$, and hence $\tilde{T}$ is TU.
    \end{enumerate}
\end{proof}

\begin{remark}
    Vectors $c_{0}$, $c_{1}$, and $c_{2}$ can be defined directly in terms of entries of $B_{2}$, e.g., $c_{2}$ consists of entries of $B_{2}$ indexed by $(X_{2} \setminus \{x_{2}\}) \times \{y_{0}\}$.
\end{remark}

\begin{lemma}\label{lem:three_sum_A_1_ext_2_TU}
    Let $B_{1}$ be a TU canonical signing of $B_{1}^{(0)}$. Let $d_{0} = D_{1, 0} (x_{0}, \cdot)$, $d_{1} = D_{1, 0} (x_{1}, \cdot)$, and $d_{2} = d_{0} - d_{1}$. Then the following properties hold.
    \begin{enumerate}
        \item\label{item:three_sum_A_1_ext_d01_eq} For every $j \in Y_{2}$, we have $[d_{0} (i) / d_{1} (i)] \in \{0, \pm 1\}^{\{x_{0}, x_{1}\}} \setminus \{[1 / -1] , [-1 / 1]\}$.
        % \item\label{item:three_sum_A_1_ext_2_vec_sign} $d_{2}$ is a signing of $D_{1, 0}^{(0)} (x_{0}, \cdot) + D_{1, 0}^{(0)} (x_{1}, \cdot)$.
        \item\label{item:three_sum_A_1_ext_2_TU} $[A_{1} / d_{0} / d_{1} / d_{2}]$ is TU.
    \end{enumerate}
\end{lemma}

\begin{proof}
    Apply Lemma~\ref{lem:three_sum_A_2_ext_2_TU} to $B_{1}^{T}$, or repeat the same argument up to interchanging rows and columns.
\end{proof}

\begin{lemma}\label{lem:three_sum_canonical_signing_properties}
    Let $B_{1}$ and $B_{2}$ be TU canonical signings of $B_{1}^{(0)}$ and $B_{2}^{(0)}$, respectively.
    \begin{itemize}
        \item Let $c_{0} = D_{0, 2} (\cdot, y_{0})$, $c_{1} = D_{0, 2} (\cdot, y_{1})$, and $c_{2} = c_{0} - c_{1}$.
        \item Let $d_{0} = D_{1, 0} (x_{0}, \cdot)$, $d_{1} = D_{1, 0} (x_{1}, \cdot)$, and $d_{2} = d_{0} - d_{1}$.
        \item If $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}$, let $r_{0} = d_{0}$, $r_{1} = -d_{1}$, $r_{2} = d_{2}$. If $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}$, let $r_{0} = d_{2}$, $r_{1} = d_{1}$, $r_{2} = d_{0}$.
        \item Let $D$ be the bottom-left block in the canonical signing $B$ of $B^{(0)}$ corresponding to $B_{1}$ and $B_{2}$
    \end{itemize}
    Then the following properties hold.
    \begin{enumerate}
        \item\label{item:three_sum_canonical_signing_D_eq} $D = c_{0} \cdot r_{0} + c_{1} \cdot r_{1}$.
        \item\label{item:three_sum_canonical_signing_D_rows} Rows of $D$ are in $[\pm r_{0} / \pm r_{1} / \pm r_{2} / 0]$.
        \item\label{item:three_sum_canonical_signing_D_cols} Columns of $D$ are in $[\pm c_{0} \mid \pm c_{1} \mid \pm c_{2} \mid 0]$.
        \item\label{item:three_sum_canonical_signing_TU_A_2_cs} $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$ is TU.
        \item\label{item:three_sum_canonical_signing_TU_A_2_D} $[A_{2} \mid D]$ is TU.
        \item\label{item:three_sum_canonical_signing_TU_A_1_rs} $[A_{1} / r_{0} / r_{1} / r_{2}]$ is TU.
        \item\label{item:three_sum_canonical_signing_TU_A_1_D} $[A_{1} / D]$ is TU.
        \item $[c_{0} \mid c_{1}]$ contains $D_{0}$ (the canonical signing of $D_{0}^{(0)}$) as a submatrix.
    \end{enumerate}
\end{lemma}

\begin{proof}
    \begin{enumerate}
        \item Follows via a direct calculation.\todo{need details?}
        \item By item~\ref{item:three_sum_canonical_signing_D_eq}, for every $i \in X_{2}$ we have $D (i, \cdot) = c_{0} (i) \cdot r_{0} + c_{1} (i) \cdot r_{1}$. By Lemma~\ref{lem:three_sum_A_2_ext_1_TU}.\ref{item:three_sum_A_1_ext_d01_eq}, we know that $[c_{0} (i) \mid c_{1} (i)] \in \{0, \pm 1\}^{\{y_{0}, y_{1}\}} \setminus \{[1 \mid -1] , [-1 \mid 1]\}$. Therefore, $D (i, \cdot)$ is equal to either $0$, $\pm r_{0}$, $\pm r_{1}$, or $\pm (r_{0} + r_{1}) = \pm r_{2}$.
        \item Holds by the same argument as item~\ref{item:three_sum_canonical_signing_D_rows} up to interchanging rows and columns.
        \item Holds by Lemma~\ref{lem:three_sum_A_2_ext_2_TU}.\ref{item:three_sum_A_2_ext_2_TU}.
        \item By item~\ref{item:three_sum_canonical_signing_D_cols}, columns of $[A_{2} \mid D]$ are in $[A_{2} \mid \pm c_{0} \mid \pm c_{1} \mid \pm c_{2} \mid 0]$. Since $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$ is TU and since adding zero columns and copies of columns multiplied by $\pm 1$ factors preserves TUness, $[A_{2} \mid D]$ is also TU.
        \item By Lemma~\ref{lem:three_sum_A_1_ext_2_TU}.\ref{item:three_sum_A_1_ext_2_TU} (or by the same argument as item~\ref{item:three_sum_canonical_signing_TU_A_2_cs} up to interchanging rows and columns), $[A_{1} / d_{0} / d_{1} / d_{2}]$ is TU. Since TUness is preserved under multiplication of rows by $\pm 1$ factors (and changing row order), $[A_{1} / r_{0} / r_{1} / r_{2}]$ is also TU.
        \item Holds by the same argument as item~\ref{item:three_sum_canonical_signing_TU_A_2_D} up to interchanging rows and columns.
        \item Holds by construction.
    \end{enumerate}
\end{proof}

\begin{definition}\label{def:three_sum_alt_form}
    Let $A_{1} \in \mathbb{Q}^{X_{1} \cup Y_{1}}$, $A_{2} \in \mathbb{Q}^{X_{2} \cup Y_{2}}$, $c_{0}, c_{1} \in \mathbb{Q}^{X_{2}}$, $r_{0}, r_{1} \in \mathbb{Q}^{Y_{1}}$. Let $D = c_{0} \cdot r_{0} + c_{1} \cdot r_{1}$. Suppose that properties 2--8 from the statement of Lemma~\ref{lem:three_sum_canonical_signing_properties} are satisfied for $A_{1}$, $A_{2}$, $c_{0}$, $c_{1}$, $r_{0}$, $r_{1}$. Given $k \in \mathbb{Z}_{\geq 1}$, define $\mathrm{Proposition}(A_{1}, A_{2}, c_{0}, c_{1}, r_{0}, r_{1}, k)$ to mean ``$C = \begin{NiceArray}{cc}[hvlines] A_{1} & 0 \\ D & A_{2} \\ \end{NiceArray}$ is $k$-TU".
\end{definition}

\begin{lemma}\label{lem:three_sum_alt_form_1_TU}
    Assume the notation of Definition~\ref{def:three_sum_alt_form}. Then $\mathrm{Proposition}(A_{1}, A_{2}, c_{0}, c_{1}, r_{0}, r_{1}, 1)$ holds.
\end{lemma}

\begin{proof}
    Every entry of $C$ is in one of four blocks: $0$, $A_{1}$, $D$, $A_{2}$. By the assumptions of Definition~\ref{def:three_sum_alt_form}, all of these blocks are TU. Thus, $C$ is $1$-TU.
\end{proof}

\begin{lemma}\label{lem:three_sum_alt_form_pivot}
    Assume the notation of Definition~\ref{def:three_sum_alt_form}. Let $i \in X_{1}$, let $T = [A_{1} (i, \cdot) / D]$. Suppose we pivot on entry $T (i, j) \in \{\pm 1\}$ in $T$ and obtain matrix $T' = [a' / D']$. Then columns of $D'$ are in $[\pm c_{0} \mid \pm c_{1} \mid \pm (c_{0} - c_{1}) \mid 0]$.
\end{lemma}

\begin{proof}
    Since $T$ is a submatrix of $[A_{1} / D]$, which is TU by assumptions of Definition~\ref{def:three_sum_alt_form}, we have that $T$ is TU. Since pivoting preserves TUness, $T'$ is also TU. To prove the claim, perform an exhaustive case distinction on what pivot column $p$ in $T$ could be and what another column $q$ in $T$ could be. This uniquely determines the resulting columns $p'$ and $q'$ in $T'$ by the pivot formula. In every case, either $[p' \mid q']$ contains a submatrix with determinant not in $\{0, \pm 1\}$, which contradicts TUness of $T'$, or the restriction of $p'$ and $q'$ to $X_{2}$ is in $[\pm c_{0} \mid \pm c_{1} \mid \pm (c_{0} - c_{1}) \mid 0]$).\todo{need details?}
\end{proof}

\begin{lemma}\label{lem:three_sum_alt_form_k_TU_induction}
    Assume the notation of Definition~\ref{def:three_sum_alt_form}. Let $k \in \mathbb{Z}_{\geq 2}$. Suppose $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k - 1)$ holds for all $A_{1}'$, $r_{0}'$, and $r_{1}'$ satisfying the assumptions of Definition~\ref{def:three_sum_alt_form} (together with $A_{2}$, $c_{0}$, and $c_{1}$). Then $\mathrm{Proposition}(A_{1}, A_{2}, c_{0}, c_{1}, r_{0}, r_{1}, k)$ holds.
\end{lemma}

\begin{proof}
    Let $V$ be a $k \times k$ submatrix of $C$. For the sake of deriving a contradiction assume that $\det V \notin \{0, \pm 1\}$.

    Suppose that $V$ is a submatrix of $[A_{1} / D]$, $[A_{1} \mid 0]$, $[D \mid A_{2}]$, or $[0 / A_{2}]$. Since all of those four matrices are TU by the assumptions of Definition~\ref{def:three_sum_alt_form}, we have $\det V \in \{0, \pm 1\}$. Thus, $V$ shares at least one row and one column index with $A_{1}$ and $A_{2}$ each.

    Consider the row index shared by $V$ and $A_{1}$. Note that this row in $V$ cannot consist of only $0$ entries, as otherwise $\det V = 0$. Thus, there exists a $\pm 1$ entry shared by $V$ and $A_{1}$. Let $i$ and $j$ denote the row and the column index of this entry, respectively.

    Perform a pivot in $C$ on the element $C (i, j)$. For every object, its modified counterpart after pivoting is denoted by the same symbol with a prime; for example, $B'$ denotes the entire matrix after the pivot. Note that the following statements hold.

    \begin{itemize}
        \item $C'$ contains a $(k - 1) \times (k - 1)$ submatrix $V'$ with $\det V' \notin \{0, \pm 1\}$. This holds by the same argument as for the $2$-sum: look at the submatrix $V'$ of $C'$ with the same row and column index sets as $V$ minus the pivot row $i$ and pivot column $j$.
        \item $C' = \begin{NiceArray}{cc}[hvlines] A_{1}' & 0 \\ D' & A_{2} \\ \end{NiceArray}$, i.e., the $0$ and the $A_{2}$ blocks remain unchanged. This holds by the same argument as for the $2$-sum: the pivot row is in the $0$ block.
        \item $[A_{1}' / D']$ is TU. This holds by the same argument as for the $2$-sum: TUness is preserved under pivoting.
        \item The columns of $D'$ are in $[0 \mid \pm c_{0} \mid \pm c_{1} \mid \pm (c_{0} - c_{1})]$. This holds by Lemma~\ref{lem:three_sum_alt_form_pivot}.
        \item There exist $r_{0}'$ and $r_{1}'$ such that $D' = c_{0} \cdot r_{0}' + c_{1} \cdot r_{1}'$ and the assumptions of Definition~\ref{def:three_sum_alt_form} are satisfied for $A_{1}'$, $A_{2}$, $c_{0}$, $c_{1}$, $r_{0}'$, $r_{1}'$. This follows from the previous bullet point by carefully checking assumptions.\todo{need details?}
        \item $C'$ is $(k - 1)$-TU. This follows from the hypothesis: $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k - 1)$ holds.
    \end{itemize}

    To sum up, after pivoting we obtain a matrix $C'$ (which can be obtained in the manner of Definition~\ref{def:three_sum_alt_form}) that is $(k - 1)$-TU and contains a $(k - 1) \times (k - 1)$ submatrix $V'$ with $\det V' \notin \{0, \pm 1\}$. This contradiction proves the lemma.
\end{proof}

\begin{lemma}\label{lem:three_sum_canonical_signing_TU}
    Let $B_{1}$ and $B_{2}$ be TU canonical signings. Then the corresponding canonical signing $B$ is TU.
\end{lemma}

\begin{proof}
    Define $A_{1}$, $A_{2}$, $c_{0}$, $c_{1}$, $r_{0}$, $r_{1}$ as in Lemma~\ref{lem:three_sum_canonical_signing_properties}. Note that canonical signing $B$ has the form of $C$ in the notation of Definition~\ref{def:three_sum_alt_form}.

    Proof by induction.

    Proposition for any $k \in \mathbb{Z}_{\geq 1}$: $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k)$ holds for all $A_{1}'$, $r_{0}'$, and $r_{1}'$ satisfying the assumptions of Definition~\ref{def:three_sum_alt_form}.

    Base: The Proposition holds for $k = 1$ by Lemma~\ref{lem:three_sum_alt_form_1_TU}.

    Step: If the Proposition holds for some $k$, then it also holds for $k + 1$ by Lemma~\ref{lem:three_sum_alt_form_k_TU_induction}.

    Conclusion: $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k)$ holds for all $k \in \mathbb{Z}_{\geq 1}$.

    Specializing the conclusion to $A_{1}$, $A_{2}$, $c_{0}$, $c_{1}$, $r_{0}$, $r_{1}$ (obtained from $B_{1}$ and $B_{2}$ as described in the statement of Lemma~\ref{lem:three_sum_canonical_signing_properties}) shows that canonical signing $B$ is $k$-TU for every $k \in \mathbb{Z}_{\geq 1}$. Thus, $B$ is TU.
\end{proof}

\begin{corollary}
    Suppose that $B_{1}^{(0)}$ and $B_{2}^{(0)}$ have TU signings. Then $B_{1} \oplus_{3} B_{2}$ has a TU signing.
\end{corollary}

\begin{proof}[Proof sketch.]
    Start with some TU signings, obtain canonical signings, apply Lemma~\ref{lem:three_sum_canonical_signing_TU}.
\end{proof}

\end{document}
