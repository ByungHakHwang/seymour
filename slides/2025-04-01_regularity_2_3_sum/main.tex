\documentclass{article}

\usepackage{amsmath} % Matrices, etc.
\usepackage{amssymb} % \mathbb, etc.

\usepackage{amsthm} % Theorem environments

\usepackage{hyperref} % Clickable links

\newtheorem{lemma}{Lemma}
\theoremstyle{definition}
\newtheorem{definition}{Definition}
\newtheorem{corollary}{Corollary}
\newtheorem{remark}{Remark}

\usepackage[margin=2.5cm]{geometry} % Page margins

\usepackage{graphicx} % Inserting images
\usepackage{nicematrix} % Typesetting advanced matrices % Manual: https://mirror.kumi.systems/ctan/macros/latex/contrib/nicematrix/nicematrix.pdf
\usepackage{todonotes} % Todos

% Header
\title{Proof of Regularity of 2- and 3-Sum of Matroids}
\author{Ivan Sergeev}
\date{March--April 2025}

\begin{document}

\maketitle

\section{2-Sum of Regular Matroids Is Regular}

\begin{lemma}\label{lem:pivot_submatrix_det}
    Let $A$ be a $k \times k$ matrix. Let $r, c \in \{1, \dots, k\}$ be a row and column index, respectively, such that $a_{rc} \neq 0$. Let $A'$ denote the matrix obtained from $A$ by performing a real pivot on $a_{rc}$. Then there exists a $(k - 1) \times (k - 1)$ submatrix $A''$ of $A'$ with $|\det A''| = \frac{|\det A|}{|a_{rc}|}$.
\end{lemma}

\begin{proof}
    Let $A''$ be the submatrix of $A'$ given by row index set $R = \{1, \dots, k\} \setminus \{r\}$ and column index set $C = \{1, \dots, k\} \setminus \{c\}$. By the explicit formula for pivoting in $A$ on $a_{rc}$, the entries of $A''$ are given by $a_{ij}'' = a_{ij} - \frac{a_{ic} a_{rj}}{a_{rc}}$. Using the linearity of the determinant, we can express $\det A''$ as
    \[
        \det A'' = \det A' - \sum_{k \in C} \frac{a_{rk}}{a_{rc}} \det B_{k}''
    \]
    where $B_{k}''$ is a matrix obtained from $A''$ by replacing column $a_{\cdot k}''$ with the pivot column $a_{\cdot c}$ without the pivot element $a_{rc}$.

    By the cofactor expansion in $A$ along row $r$, we have
    \[
        \det A = \sum_{k = 1}^{n} (-1)^{r + k} a_{rk} \det B_{r, k}
    \]
    where $B_{r, k}$ is obtained from $A$ by removing row $r$ and column $k$. By swapping the order of columns in $B_{r, k}$ to match the form of $B_{k}$, we get
    \[
        \det A = (-1)^{r + c} (a_{rc} \det A' - \sum_{k \in C} a_{rk} \det B_{k}'').
    \]

    By combining the above results, we get $|\det A''| = \frac{|\det A|}{|a_{rc}|}$.
\end{proof}

\begin{corollary}\label{cor:pivot_submatrix_det}
    Let $A$ be a $k \times k$ matrix with $\det A \notin \{0, \pm 1\}$. Let $r, c \in \{1, \dots, k\}$ be a row and column index, respectively, and suppose that $a_{rc} \in \{\pm 1\}$. Let $A'$ denote the matrix obtained from $A$ by performing a real pivot on $a_{rc}$. Then there exists a $(k - 1) \times (k - 1)$ submatrix $A''$ of $A'$ with $\det A'' \notin \{0, \pm 1\}$.
\end{corollary}

\begin{proof}
    Since $a_{rc} \in \{\pm 1\}$, by Lemma~\ref{lem:pivot_submatrix_det} there exists a $(k - 1) \times (k - 1)$ submatrix $A''$ with $|\det A| = |\det A''|$. Since $\det A \notin \{0, \pm 1\}$, we have $\det A'' \notin \{0, \pm 1\}$.
\end{proof}

\begin{definition}\label{def:two_sum}
    Let $B_{1}, B_{2}$ be matrices with $\{0, \pm 1\}$ entries expressed as $B_{1} = \left[A_{1} / x\right]$ and $B_{2} = \left[y \mid A_{2}\right]$, where $x$ is a row vector, $y$ is a column vector, and $A_{1}, A_{2}$ are matrices of appropriate dimensions. Let $D$ be the outer product of $y$ and $x$. The $2$-sum of $B_{1}$ and $B_{2}$ is defined as
    \[
        B_{1} \oplus_{2, x, y} B_{2} = \begin{bmatrix}
            A_{1} & 0 \\
            D & A_{2} \\
        \end{bmatrix}.
    \]
\end{definition}

\begin{definition}\label{def:k_tu}
    Given $k \in \mathbb{Z}_{\geq 1}$, we say that a matrix $A$ is $k$-TU if every square submatrix of $A$ of size $k$ has determinant in $\{0, \pm 1\}$.
\end{definition}

\begin{remark}
    Note that a matrix is TU if and only if it is $k$-TU for every $k \in \mathbb{Z}_{\geq 1}$.
\end{remark}

\begin{lemma}\label{lem:two_sum_1_2_tu}
    Let $B_{1}$ and $B_{2}$ be TU matrices and let $B = B_{1} \oplus_{2, x, y} B_{2}$. Then $B$ is $1$-TU and $2$-TU.
\end{lemma}

\begin{proof}
    To see that $B$ is $1$-TU, note that $B$ is a $\{0, \pm 1\}$ matrix by construction.

    To show that $B$ is $2$-TU, let $V$ be a $2 \times 2$ submatrix $V$ of $B$. If $V$ is a submatrix of $\left[A_{1} / D\right]$, $\left[D \mid A_{2}\right]$, $\left[A_{1} \mid 0\right]$, or $\left[0 / A_{2}\right]$, then $\det V \in \{0, \pm 1\}$, as all of those four matrices are TU. Otherwise $V$ shares exactly one row and one column index with both $A_{1}$ and $A_{2}$. Let $i$ be the row shared by $V$ and $A_{1}$ and $j$ be the column shared by $V$ and $A_{2}$. Note that $V_{ij} = 0$. Thus, up to sign, $\det V$ equals the product of the entries on the diagonal not containing $V_{ij}$. Since both of those entries are in $\{0, \pm 1\}$, we have $\det V \in \{0, \pm 1\}$.
\end{proof}

\begin{lemma}\label{lem:two_sum_k_tu_induction}
    Let $k \in \mathbb{Z}_{\geq 1}$. Suppose that for any TU matrices $B_{1}$ and $B_{2}$ their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is $\ell$-TU for every $\ell < k$. Then for any TU matrices $B_{1}$ and $B_{2}$ their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is also $k$-TU.
\end{lemma}

\begin{proof}
    For the sake of deriving a contradiction, suppose there exist TU matrices $B_{1}$ and $B_{2}$ such that their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is not $k$-TU. Then $B$ contains a $k \times k$ submatrix $V$ with $\det V \notin \{0, \pm 1\}$.

    Note that $V$ cannot be a submatrix of $\left[A_{1} / D\right]$, $\left[D \mid A_{2}\right]$, $\left[A_{1} \mid 0\right]$, or $\left[0 / A_{2}\right]$, as all of those four matrices are TU. Thus, $V$ shares at least one row and one column index with $A_{1}$ and $A_{2}$ each.

    Consider the row of $V$ whose index appears in $A_{1}$. Note that it cannot consist of only $0$ entries, as otherwise $\det V = 0$. Thus there exists a $\pm 1$ entry shared by $V$ and $A_{1}$. Let $r$ and $c$ denote the row and column index of this entry, respectively.

    Perform a rational pivot in $B$ on the element $B_{rc}$. For every object, its modified counterpart after pivoting is denoted by the same symbol with an added tilde; for example, $\tilde{B}$ denotes the entire matrix after the pivot. Note that after pivoting the following statements hold:
    \begin{itemize}
        \item $\left[\tilde{A}_{1} / \tilde{D}\right]$ is TU, since TUness is preserved by pivoting.
        \item $\tilde{A}_{2} = A_{2}$, i.e., $A_{2}$ remains unchanged. This holds because of the $0$ block in $B$.
        \item $\tilde{D}$ consists of copies of $y$ scaled by factors in $\{0, \pm 1\}$. This can be verified via a case distinction and a simple calculation.
        \item $\left[\tilde{D} \mid \tilde{A}_{2}\right]$ is TU, since this matrix consists of $A_{2}$ and copies of $y$ scaled by factors $\{0, \pm 1\}$.
        \item $\tilde{D}$ can be represented as an outer product of a column vector $\tilde{y}$ and a row vector $\tilde{x}$, and we can define $\tilde{B}_{1} = \left[\tilde{A}_{1} / \tilde{x}\right]$ and $\tilde{B}_{2} = \left[\tilde{y} \mid \tilde{A}_{2}\right]$ similar to $B_{1}$ and $B_{2}$, respectively. Note that $\tilde{B}_{1}$ and $\tilde{B}_{2}$ have the same size as $B_{1}$ and $B_{2}$, respectively, are both TU, and satisfy $\tilde{B} = \tilde{B}_{1} \oplus_{2, \tilde{x}, \tilde{y}} \tilde{B}_{2}$.
        \item $\tilde{B}$ contains a square submatrix $\tilde{V}$ of size $k - 1$ with $\det \tilde{V} \notin \{0, \pm 1\}$. Indeed, by Corollary~\ref{cor:pivot_submatrix_det} from Lemma~\ref{lem:pivot_submatrix_det}, pivoting in $V$ on the element $B_{rc}$ results in a matrix containing a $(k - 1) \times (k - 1)$ submatrix $V''$ with $\det V'' \in \{0, \pm 1\}$. Since $V$ is a submatrix of $B$, the submatrix $V''$ corresponds to a submatrix $\tilde{V}$ of $\tilde{B}$ with the same property.
    \end{itemize}
    To sum up, after pivoting we obtain a matrix $\tilde{B}$ that represents a $2$-sum of TU matrices $\tilde{B}_{1}$ and $\tilde{B}_{2}$ and contains a square submatrix of size $k - 1$ with determinant not in $\{0, \pm 1\}$. This is a contradiction with $(k - 1)$-TUness of $\tilde{B}$, which proves the lemma.
\end{proof}

\begin{lemma}\label{lem:two_sum_tu}
    Let $B_{1}$ and $B_{2}$ be TU matrices. Then $B_{1} \oplus_{2, x, y} B_{2}$ is also TU.
\end{lemma}

\begin{proof}
    Proof by induction.

    Proposition for any $k \in \mathbb{Z}_{\geq 1}$: For any TU matrices $B_{1}$ and $B_{2}$, their $2$-sum $B = B_{1} \oplus_{2, x, y} B_{2}$ is $\ell$-TU for every $\ell \leq k$.

    Base: The Proposition holds for $k = 1$ and $k = 2$ by Lemma~\ref{lem:two_sum_1_2_tu}.

    Step: If the Proposition holds for some $k$, then it also holds for $k + 1$ by Lemma~\ref{lem:two_sum_k_tu_induction}.

    Conclusion: For any TU matrices $B_{1}$ and $B_{2}$, their $2$-sum $B_{1} \oplus_{2, x, y} B_{2}$ is $k$-TU for every $k \in \mathbb{Z}_{\geq 1}$. Thus, $B_{1} \oplus_{2, x, y} B_{2}$ is TU.
\end{proof}

\newpage
\section{3-Sum of Regular Matroids Is Regular}

\begin{definition}\label{def:three_sum}
    Let $B_{1}^{(0)} \in \mathbb{Z}_{2}^{(X_{1} \cup \{x_{0}, x_{1}\}) \times (Y_{1} \cup \{y_{2}\})}, B_{2}^{(0)} \in \mathbb{Z}_{2}^{(X_{2} \cup \{x_{2}\}) \times (Y_{2} \cup \{y_{0}, y_{1}\})}$ be matrices of the form
    \[
        B_{1}^{(0)} =
        \begin{NiceArray}{ccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}^{(0)}} & & & & \Block[draw]{4-1}{0} \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}^{(0)}} & & \Block[draw]{2-2}{D_{0}^{(0)}} & & \Block[draw]{1-1}{1} \\
             & & & & \Block[draw]{1-1}{1} \\
        \end{NiceArray}
        , \quad
        B_{2}^{(0)} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{2-2}{D_{0}^{(0)}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}^{(0)}} \\
             & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{2}^{(0)}} \\
            \\
        \end{NiceArray},
    \]
    where $D_{0}^{(0)} (x_{0}, y_{0}) = 1$, $D_{0}^{(0)} (x_{0}, y_{1}) \in \{0, 1\}$, $D_{0}^{(0)} (x_{1}, y_{0}) = 0$, and $D_{0}^{(0)} (x_{1}, y_{1}) = 1$. Let $D_{12}^{(0)} = D_{2}^{(0)} \cdot (D_{0}^{(0)})^{-1} \cdot D_{1}^{(0)}$ (note that $D_{0}^{(0)}$ is invertible by construction). Then the $3$-sum of $B_{1}^{(0)}$ and $B_{2}^{(0)}$ is
    \[
        B^{(0)} = B_{1}^{(0)} \oplus_{3} B_{2}^{(0)} =
        \begin{NiceArray}{cccccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}^{(0)}} & & & & \Block[draw]{4-4}{0} & & & \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}^{(0)}} & & \Block[draw]{2-2}{D_{0}^{(0)}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}^{(0)}} \\
             & & & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{12}^{(0)}} & & \Block[draw]{2-2}{D_{2}^{(0)}} \\
            \\
        \end{NiceArray} \in \mathbb{Z}_{2}^{(X_{1} \cup X_{2}) \times (Y_{1} \times Y_{2})}.
    \]
    Here $x_{2} \in X_{1}$, $x_{0}, x_{1} \in X_{2}$, $y_{0}, y_{1} \in Y_{1}$, $y_{2} \in Y_{2}$, $A_{1}^{(0)} \in \mathbb{Z}_{2}^{X_{1} \times Y_{1}}$, $A_{2}^{(0)} \in \mathbb{Z}_{2}^{X_{2} \times Y_{2}}$, $D_{1}^{(0)} \in \mathbb{Z}_{2}^{\{x_{0}, x_{1}\} \times (Y_{1} \setminus \{y_{0}, y_{1}\})}$, $D_{2}^{(0)} \in \mathbb{Z}_{2}^{(X_{2} \setminus \{x_{0}, x_{1}\}) \times \{y_{0}, y_{1}\}}$, $D_{0}^{(0)} \in \mathbb{Z}_{2}^{\{x_{0}, x_{1}\} \times \{y_{0}, y_{1}\}}$, $D_{12}^{(0)} \in \mathbb{Z}_{2}^{(X_{2} \setminus \{x_{0}, x_{1}\}) \times (Y_{1} \setminus \{y_{0}, y_{1}\})}$. The indexing is kept consistent between $B_{1}^{(0)}$, $B_{2}^{(0)}$, and $B^{(0)}$. To simplify notation, we use the following shorthands:
    \[
        D_{1, 12}^{(0)} = \begin{NiceArray}{c}[hvlines] D_{1}^{(0)} \\ D_{12}^{(0)} \\ \end{NiceArray}, \quad
        D_{0, 2}^{(0)} = \begin{NiceArray}{c}[hvlines] D_{0}^{(0)} \\ D_{2}^{(0)} \\ \end{NiceArray}, \quad
        D_{1, 0}^{(0)} = \begin{NiceArray}{cc}[hvlines] D_{1}^{(0)} & D_{0}^{(0)} \\ \end{NiceArray}, \quad
        D_{12, 2}^{(0)} = \begin{NiceArray}{cc}[hvlines] D_{12}^{(0)} & D_{2}^{(0)} \\ \end{NiceArray}, \quad
        D^{(0)} = \begin{NiceArray}{cc}[hvlines] D_{1}^{(0)} & D_{0}^{(0)} \\ D_{12}^{(0)} & D_{2}^{(0)} \\ \end{NiceArray}.
    \]
\end{definition}

The following lemma justifies the additional assumption on the entries of $D_{0}^{(0)}$.

\begin{lemma}\label{lem:matrix_z2_2_2_rank_2}
    Let $D_{0}^{(0)} \in \mathbb{Z}_{2}^{2 \times 2}$ be non-singular. Then (up to row and column indices)
    \[
        D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}
        \quad \text{or} \quad
        D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}
    \]
\end{lemma}

\begin{proof}
    Verify by complete enumeration.\todo{need details?}
\end{proof}

\begin{definition}\label{def:three_sum_canonical_signing}
    We call $B_{1}$ and $B_{2}$ canonical signings of $B_{1}^{(0)}$ and $B_{2}^{(0)}$, respectively, if they have the form
    \[
        B_{1} =
        \begin{NiceArray}{ccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}} & & & & \Block[draw]{4-1}{0} \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}} & & \Block[draw]{2-2}{D_{0}} & & \Block[draw]{1-1}{1} \\
             & & & & \Block[draw]{1-1}{1} \\
        \end{NiceArray}
        , \quad
        B_{2} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{2-2}{D_{0}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}} \\
             & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{2}} \\
            \\
        \end{NiceArray}
    \]
    where every block in $B_{1}$ and $B_{2}$ is a signing of the corresponding block in $B_{1}^{(0)}$ and $B_{2}^{(0)}$, and $D_{0}$ is the canonical signing of $D_{0}^{(0)}$, which is defined as follows:
    \[
        \text{if } D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray} \text{ then } D_{0} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & -1 \\ \end{NiceArray}, \quad
        \text{if } D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray} \text{ then } D_{0} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}.
    \]
    Given canonical signings $B_{1}$ and $B_{2}$, the corresponding canonical signing of $B^{(0)}$ is defined as
    \[
        B =
        \begin{NiceArray}{cccccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{4-4}{A_{1}} & & & & \Block[draw]{4-4}{0} & & & \\
            \\
            \\
            & & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-1}{0} \\
            \Block[draw]{2-2}{D_{1}} & & \Block[draw]{2-2}{D_{0}} & & \Block[draw]{1-1}{1} \Block[draw]{4-4}{A_{2}} \\
             & & & & \Block[draw]{1-1}{1} \\
            \Block[draw]{2-2}{D_{12}} & & \Block[draw]{2-2}{D_{2}} \\
            \\
        \end{NiceArray}
    \]
    where $D_{12} = D_{2} \cdot (D_{0})^{-1} \cdot D_{1}$. (Note that $(D_{0})^{-1}$ is over $\mathbb{Q}$.)
\end{definition}

The following lemma helps construct canonical signings from arbitrary initial TU signings.

\begin{lemma}\label{lem:three_sum_signing_helper}
    Let $Q'$ be a TU signing of the matrix
    \[
        T = \begin{NiceArray}{ccc}[hvlines]
            1 & 1 & 0 \\
            \Block[draw]{2-2}{D_{0}^{(0)}} & & 1 \\
             & & 1 \\
        \end{NiceArray} \in \mathbb{Z}_{2}^{(x_{0}, x_{1}, x_{2}) \times (y_{0}, y_{1}, y_{2})}
    \]
    where $D_{0}^{(0)} (x_{0}, x_{0}) = 1$, $D_{0}^{(0)} (x_{0}, x_{1}) \in \{0, 1\}$, $D_{0}^{(0)} (x_{1}, x_{0}) = 0$, and $D_{0}^{(0)} (x_{1}, x_{1}) = 1$. Let $u \in \{0, \pm 1\}^{(x_{0}, x_{1}, x_{2})}$, $v \in \{0, \pm 1\}^{(y_{0}, y_{1}, y_{2})}$, %$D_{0}$,
    and $Q$ be the following vectors and matrices:
    \begin{gather*}
        u(x_{0}) = Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}), \quad
        u(x_{1}) = Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}) \cdot Q' (x_{1}, y_{2}), \quad
        u(x_{2}) = 1, \\
        v(y_{0}) = Q' (x_{2}, y_{0}), \quad
        v(y_{1}) = Q' (x_{2}, y_{1}), \quad
        v(y_{2}) = Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}), \\
        % D_{0} (i, j) = D_{0}' (i, j) \cdot u(i) \cdot v(j) \quad \forall i \in \{x_{0}, x_{1}, \ x_{2}\}, j \in \{y_{0}, y_{1}, y_{2}\}, \\
        Q (i, j) = Q' (i, j) \cdot u(i) \cdot v(j) \quad \forall i \in \{x_{0}, x_{1}, x_{2}\}, \ j \in \{y_{0}, y_{1}, y_{2}\}.
    \end{gather*}
    Then $Q$ is a TU signing of $T$ and $Q = \begin{NiceArray}{ccc}[hvlines] 1 & 1 & 0 \\ \Block[draw]{2-2}{D_{0}} & & 1 \\ & & 1 \\ \end{NiceArray}$ where $D_{0}$ is the respective canonical signing of $D_{0}^{(0)}$.
\end{lemma}

\begin{proof}[Direct proof of Lemma~\ref{lem:three_sum_signing_helper}.]
    Since $Q'$ is a TU signing of $T$ and $Q$ is obtained from $Q'$ by multiplying rows and columns by $\pm 1$ factors, $Q$ is also a TU signing of $T$. By construction, we have
    \begin{align*}
        Q (x_{2}, y_{0}) &= Q' (x_{2}, y_{0}) \cdot 1 \cdot Q' (x_{2}, y_{0}) = 1, \\
        Q (x_{2}, y_{1}) &= Q' (x_{2}, y_{1}) \cdot 1 \cdot Q' (x_{2}, y_{1}) = 1, \\
        Q (x_{2}, y_{2}) &= 0, \\
        Q (x_{0}, y_{0}) &= Q' (x_{0}, y_{0}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0})) \cdot Q' (x_{2}, y_{0}) = 1, \\
        Q (x_{0}, y_{1}) &= Q' (x_{0}, y_{1}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0})) \cdot Q' (x_{2}, y_{1}), \\
        Q (x_{0}, y_{2}) &= Q' (x_{0}, y_{2}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0})) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2})) = 1, \\
        Q (x_{1}, y_{0}) &= 0, \\
        Q (x_{1}, y_{1}) &= Q' (x_{1}, y_{1}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}) \cdot Q' (x_{1}, y_{2})) \cdot (Q' (x_{2}, y_{1})), \\
        Q (x_{1}, y_{2}) &= Q' (x_{1}, y_{2}) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2}) \cdot Q' (x_{1}, y_{2})) \cdot (Q' (x_{2}, y_{0}) \cdot Q' (x_{0}, y_{0}) \cdot Q' (x_{0}, y_{2})) = 1.
    \end{align*}
    Thus, it remains to check that $Q (x_{0}, y_{1})$ and $Q (x_{1}, y_{1})$ are correct.

    First, consider the entry $Q (x_{0}, y_{1})$. If $D_{0}^{(0)} (x_{0}, y_{1}) = 0$, then $Q (x_{0}, y_{1}) = 0$, as needed. Otherwise, if $D_{0}^{(0)} (x_{0}, y_{1}) = 1$, then $Q (x_{0}, y_{1}) \in \{\pm 1\}$, as $Q$ is a signing of $T$. Our goal is to show that $Q (x_{0}, y_{1}) = 1$. For the sake of deriving a contradiction suppose that $Q (x_{0}, y_{1}) = -1$. Then the determinant of the submatrix of $Q$ indexed by $\{x_{0}, x_{2}\} \times \{y_{0}, y_{1}\}$ is
    \[
        \det \begin{NiceArray}{cc}[hvlines] 1 & -1 \\ 1 & 1 \\ \end{NiceArray} = 2 \notin \{0, \pm 1\},
    \]
    which contradicts TUness of $Q$. Thus, $Q (x_{0}, y_{1}) = 1$, as needed.

    Consider the entry $Q (x_{1}, y_{1})$. Since $Q$ is a signing of $T$, we have $Q (x_{1}, y_{1}) \in \{\pm 1\}$. Note that we know all the other entries of $Q$, so we can determine the sign of $Q (x_{1}, y_{1})$ using TUness of $Q$. Consider two cases.
    \begin{enumerate}
        \item Suppose that $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}$. If $Q (x_{1}, y_{1}) = 1$, then
        $
            \det Q = \det \begin{NiceArray}{ccc}[hvlines]
                1 & 1 & 0 \\
                1 & 0 & 1 \\
                0 & 1 & 1 \\
            \end{NiceArray} = -2 \notin \{0, \pm 1\},
        $
        which contradicts TUness of $Q$. Thus, $Q (x_{1}, y_{1}) = -1$, as needed.
        \item Suppose that $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}$. If $Q (x_{1}, y_{1}) = -1$, then
        $
            \det Q = \det \begin{NiceArray}{ccc}[hvlines]
                1 & 1 & 0 \\
                1 & 1 & 1 \\
                0 & -1 & 1 \\
            \end{NiceArray} = 2 \notin \{0, \pm 1\},
        $
        which contradicts TUness of $Q$. Thus, $Q (x_{1}, y_{1}) = 1$, as needed.
    \end{enumerate}
\end{proof}

% \begin{proof}[Alternative proof of Lemma~\ref{lem:three_sum_signing_helper}.]
%     First, we modify $Q'$ by multiplying column $y_{0}$ by $Q(x_{2}, y_{0})$, column $y_{1}$ by $Q' (x_{2}, y_{1})$, row $x_{0}$ by $Q' (x_{0}, y_{2})$, and row $x_{1}$ by $Q' (x_{1}, y_{2})$. As a result, $Q'$ is transformed into
%     \[
%         Q'' = \begin{NiceArray}{ccc}[hvlines]
%             1 & 1 & 0 \\
%             \Block{2-2}{D_{0}''} & & 1 \\
%             & & 1 \\
%         \end{NiceArray}
%     \]
%     where $D_{0}''$ is a signing of $D_{0}^{(0)}$. Since $Q'$ is a TU signing of $T$ and $Q''$ is obtained from $Q'$ by multiplying rows and columns by $\pm 1$ factors, $Q''$ is also a TU signing of $T$. Moreover, $D_{0}''$ is TU as a submatrix of $Q''$, which is TU. Consider two cases.
%     \begin{enumerate}
%         \item If $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}$, then
%         \[
%             D_{0}'' \in \left\{
%                 \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & -1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] -1 & 0 \\ 0 & 1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] -1 & 0 \\ 0 & -1 \\ \end{NiceArray}
%             \right\}.
%         \]
%         Since $D_{0}''$ is TU, the first and the last option for $D_{0}''$ are eliminated, as
%         \[
%             \det \begin{NiceArray}{ccc}[hvlines]
%                 1 & 1 & 0 \\
%                 1 & 0 & 1 \\
%                 0 & 1 & 1 \\
%             \end{NiceArray} = -2 \notin \{0, \pm 1\}, \quad
%             \det \begin{NiceArray}{ccc}[hvlines]
%                 1 & 1 & 0 \\
%                 -1 & 0 & 1 \\
%                 0 & -1 & 1 \\
%             \end{NiceArray} = 2 \notin \{0, \pm 1\}.
%         \]
%         Thus, $D_{0}'' = \pm \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & -1 \\ \end{NiceArray}$. Therefore, either $Q''$ is already in the desired form, or it remains to flip the sign of $D_{0}''$, which can be accomplished by multiplying rows $x_{0}$ and $x_{1}$ and column $y_{2}$ by $-1$. In both cases the row and column multiplications by $\pm 1$ factors are equivalent to those described by the statement of the lemma.
%         \item If $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}$, then
%             \[
%             D_{0}'' \in \left\{
%                 \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & -1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] 1 & -1 \\ 0 & 1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] 1 & -1 \\ 0 & -1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] -1 & 1 \\ 0 & 1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] -1 & 1 \\ 0 & -1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] -1 & -1 \\ 0 & 1 \\ \end{NiceArray},\;
%                 \begin{NiceArray}{cc}[hvlines] -1 & -1 \\ 0 & -1 \\ \end{NiceArray}
%             \right\}.
%         \]
%         Since $D_{0}''$ is TU, all but the first and the last option are eliminated. Indeed, if $D_{0}''$ has different signs in the $[1 \mid 1]$ row or $[1 / 1]$ column, then $Q''$ contains a submatrix with
%         \[
%             \det \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 1 & -1 \\ \end{NiceArray} = -2 \notin \{0, \pm 1\}.
%         \]
%         Thus, $D_{0}'' = \pm \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}$. Therefore, either $Q''$ is already in the desired form, or it remains to flip the sign of $D_{0}''$, which can be done by multiplying rows $x_{0}$ and $x_{1}$ and column $y_{2}$ by $-1$. In both cases the row and column multiplications by $\pm 1$ factors are equivalent to those described by the statement of the lemma.
%     \end{enumerate}
% \end{proof}

\begin{lemma}\label{lem:canonical_signing_construction}
    Let $B_{1}'$ and $B_{2}'$ be TU signings of $B_{1}^{(0)}$ and $B_{2}^{(0)}$, respectively. Let $B_{1}$ and $B_{2}$ be obtained from $B_{1}'$ and $B_{2}'$, respectively, by multiplying their rows and columns by $\pm 1$ factors from Lemma~\ref{lem:three_sum_signing_helper}. Then $B_{1}$ and $B_{2}$ are TU canonical signings.
\end{lemma}

\begin{proof}
    This follows directly from Lemma~\ref{lem:three_sum_signing_helper}.
\end{proof}

\begin{lemma}\label{lem:A_2_ext_1_TU}
    Let $B_{2}$ be a TU canonical signing of $B_{2}^{(0)}$. Let $c_{0} = (D_{0, 2})_{\cdot, y_{0}}$ and $c_{1} = (D_{0, 2})_{\cdot, y_{1}}$. Then the following matrices are TU:
    \[
        B_{2}^{(a)} = [c_{0} - c_{1} \mid c_{0} \mid A_{2}], \quad
        B_{2}^{(b)} = [c_{0} - c_{1} \mid c_{1} \mid A_{2}].
    \]
\end{lemma}

\begin{proof}
    Recall that pivoting in matrix $A$ on entry $a_{rc} \neq 0$ transforms the matrix as follows:
    \[
        \begin{NiceMatrix}[hvlines]
            a_{rc} & a_{rj} \\
            a_{ic} & a_{ij} \\
        \end{NiceMatrix}
        \quad \to \quad
        \begin{NiceMatrix}[hvlines,cell-space-limits=2pt]
            \frac{1}{a_{rc}} & \frac{a_{rj}}{a_{rc}} \\
            -\frac{a_{ic}}{a_{rc}} & a_{ij} - \frac{a_{rj} a_{ic}}{a_{rc}} \\
        \end{NiceMatrix}
    \]
    Pivoting in $B_{2}$ on $(x_{2}, y_{0})$ and $(x_{2}, y_{1})$ yields:
    \[
        B_{2} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{c_{0}} & \Block[draw]{4-1}{c_{1}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \CodeAfter
            \tikz \draw (1-1) circle (0.2);
        \end{NiceArray}
        \quad \to \quad
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{-c_{0}} & \Block[draw]{4-1}{c_{1} - c_{0}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \end{NiceArray}
    \]
    \[
        B_{2} =
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{c_{0}} & \Block[draw]{4-1}{c_{1}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \CodeAfter
            \tikz \draw (1-2) circle (0.2);
        \end{NiceArray}
        \quad \to \quad
        \begin{NiceArray}{cccccc}[hvlines,right-margin=1em,left-margin=1em]
            \Block[draw]{1-1}{1} & \Block[draw]{1-1}{1} & \Block[draw]{1-4}{0} & & & \\
            \Block[draw]{4-1}{c_{0} - c_{1}} & \Block[draw]{4-1}{-c_{1}} & \Block[draw]{4-4}{A_{2}} \\ \\ \\ \\
        \end{NiceArray}
    \]
    By removing row $x_{2}$ from the resulting matrices and then multiplying columns $y_{0}$ and $y_{1}$ by $\{\pm 1\}$ factors, we obtain $B_{2}^{(a)}$ and $B_{2}^{(b)}$. Since $B_{2}$ is TU and TUness is preserved under pivoting, taking submatrices, and multiplying columns by ${\pm 1}$ factors, we conclude that $B_{2}^{(a)}$ and $B_{2}^{(b)}$ are TU.
\end{proof}

\begin{lemma}\label{lem:A_2_ext_2_TU}
    Let $B_{2}$ be a TU canonical signing of $B_{2}^{(0)}$. Let $c_{0} = D_{0, 2} (\cdot, y_{0})$, $c_{1} = D_{0, 2} (\cdot, y_{1})$, and $c_{2} = c_{0} - c_{1}$. Then the following properties hold.
    \begin{enumerate}
        \item\label{item:A_2_ext_2_vec_sign} $c_{2}$ is a signing of $D_{0, 2} (\cdot, y_{0}) + D_{0, 2} (\cdot, y_{1})$.
        \item\label{item:A_2_ext_2_TU} $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$ is TU.
    \end{enumerate}
\end{lemma}

\begin{proof}
    \begin{enumerate}
        \item Let $r(i)$ denote a two-element row vector consisting of entries $y_{0}$ and $y_{1}$ in row $i$ of $B_{2}$. Note that $r(x_{2}) = [1 \mid 1]$.

        First, suppose that $r(i) = [1 \mid -1]$ or $r(i) = [-1 \mid 1]$. Then the matrix composed of rows $i$ and $x_{2}$ has
        \[
            \det \begin{bmatrix}
                1 & 1 \\
                1 & -1 \\
            \end{bmatrix} = -2
            \quad \text{ or } \quad
            \det \begin{bmatrix}
                1 & 1 \\
                -1 & 1 \\
            \end{bmatrix} = 2,
        \]
        which is impossible as $B_{2}$ is a TU signing. Thus, these cases are not realized.

        Now, suppose that $r(i)$ is one of the following: $[0 \mid 0]$, $[0 \mid 1]$, $[1 \mid 0]$, $[1 \mid 1]$, $[0 \mid -1]$, $[-1 \mid 0]$, $[-1 \mid -1]$. In all of these cases, a direct calculation shows that $c_{2}(i) \in \{0, \pm 1\}$ and $|c_{2}(i)| = D_{0, 2} (\cdot, y_{0}) + D_{0, 2} (\cdot, y_{1})$.

        \item Let $V$ be a square submatrix of $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$. We will show that $\det V \in \{0, \pm 1\}$.

        Let $z$ denote the index of the appended column $c_{2}$. Suppose that column $z$ is not in $V$. Then $V$ is a submatrix of $B_{2}$, which is TU. Thus, $\det V \in \{0, \pm 1\}$. Going forward we assume that column $z$ is in $V$.

        Suppose that columns $y_{0}$ and $y_{1}$ are both in $V$. Then $V$ contains columns $z$, $y_{0}$, and $y_{1}$, which are linearly dependent by construction of $c_{2}$. Thus, $\det V = 0$. Going forward we assume that at most one of the columns $y_{0}$ and $y_{2}$ is in $V$.

        Suppose that column $y_{0}$ is in $V$. Then $V$ is a submatrix of $B_{2}^{(b)}$ from Lemma~\ref{lem:A_2_ext_1_TU}, and thus $\det V \in \{0, \pm 1\}$. Otherwise, $V$ is a submatrix of $B_{2}^{(a)}$ from Lemma~\ref{lem:A_2_ext_1_TU}, and so $\det V \in \{0, \pm 1\}$.

        Thus, every square submatrix $V$ of $\tilde{T}$ has $\det V \in \{0, \pm 1\}$, and hence $\tilde{T}$ is TU.
    \end{enumerate}
\end{proof}

\begin{remark}
    Vectors $c_{0}$, $c_{1}$, and $c_{2}$ can be defined directly in terms of entries of $B_{2}$, e.g., $c_{2}$ is composed of entries of $B_{2}$ indexed by $(X_{2} \setminus \{x_{2}\}) \times \{y_{0}\}$.
\end{remark}

\begin{lemma}\label{lem:A_1_ext_2_TU}
    Let $B_{1}$ be a TU canonical signing of $B_{1}^{(0)}$. Let $d_{0} = D_{1, 0} (x_{0}, \cdot)$, $d_{1} = D_{1, 0} (x_{1}, \cdot)$, and $d_{2} = d_{0} - d_{1}$. Then the following properties hold.
    \begin{enumerate}
        \item\label{item:A_1_ext_2_vec_sign} $d_{2}$ is a signing of $D_{1, 0} (x_{0}, \cdot) + D_{1, 0} (x_{1}, \cdot)$.
        \item\label{item:A_1_ext_2_TU} $[A_{1} / d_{0} / d_{1} / d_{2}]$ is TU.
    \end{enumerate}
\end{lemma}

\begin{proof}
    Apply Lemma~\ref{lem:A_2_ext_2_TU} to $B_{1}^{T}$. Transposing preserves TUness.\todo{need details?}
\end{proof}

\begin{lemma}\label{lem:canonical_signing_properties}
    Let $B_{1}$ and $B_{2}$ be TU canonical signings of $B_{1}^{(0)}$ and $B_{2}^{(0)}$, respectively.
    \begin{itemize}
        \item Let $c_{0} = D_{0, 2} (\cdot, y_{0})$, $c_{1} = D_{0, 2} (\cdot, y_{1})$, and $c_{2} = c_{0} - c_{1}$.
        \item Let $d_{0} = D_{1, 0} (x_{0}, \cdot)$, $d_{1} = D_{1, 0} (x_{1}, \cdot)$, and $d_{2} = d_{0} - d_{1}$.
        \item If $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 0 \\ 0 & 1 \\ \end{NiceArray}$, let $r_{0} = d_{0}$, $r_{1} = -d_{1}$, $r_{2} = d_{2}$. If $D_{0}^{(0)} = \begin{NiceArray}{cc}[hvlines] 1 & 1 \\ 0 & 1 \\ \end{NiceArray}$, let $r_{0} = d_{2}$, $r_{1} = d_{1}$, $r_{2} = d_{0}$.
        \item Let $D$ be the bottom-left block in the canonical signing $B$ of $B^{(0)}$ corresponding to $B_{1}$ and $B_{2}$
    \end{itemize}
    Then the following properties hold.
    \begin{enumerate}
        \item $D = c_{0} \cdot r_{0} + c_{1} \cdot r_{1}$.
        \item Rows of $D$ are in $[\pm r_{0} / \pm r_{1} / \pm r_{2} / 0]$.
        \item Columns of $D$ are in $[\pm c_{0} \mid \pm c_{1} \mid \pm c_{2} \mid 0]$.
        % \item $c_{2}$ is a signing of $(D_{0, 2})_{\cdot, y_{0}} + (D_{0, 2})_{\cdot, y_{0}}$.
        \item $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$ is TU.
        \item $[A_{2} \mid D]$ is TU.
        % \item $d_{2}$ is a signing of $(D_{1, 0})_{x_{0}, \cdot} + (D_{1, 0})_{x_{1}, \cdot}$.
        \item $[A_{1} / r_{0} / r_{1} / r_{2}]$ is TU.
        \item $[A_{1} / D]$ is TU.
    \end{enumerate}
\end{lemma}

\begin{proof}
    \begin{enumerate}
        \item Follows via a direct calculation.\todo{need details?}
        \item In the proof of Lemma~\ref{lem:A_2_ext_2_TU} we showed that rows of $[c_{0} \mid c_{1}]$ can only be of the following forms: $[0 \mid 0]$, $[0 \mid 1]$, $[1 \mid 0]$, $[1 \mid 1]$, $[0 \mid -1]$, $[-1 \mid 0]$, $[-1 \mid -1]$. Therefore, every row of $D$ is equal to either $0$, $\pm r_{0}$, $\pm r_{1}$, or $\pm (r_{0} + r_{1}) = \pm r_{2}$.
        \item Similar to the argument for rows,\todo{need details?} every column of $D$ is in $[\pm d_{0} / \pm d_{1} / \pm d_{2} / 0]$, which has the same columns as $[\pm r_{0} / \pm r_{1} / \pm r_{2} / 0]$ (up to reindexing).
        % \item Holds by Lemma~\ref{lem:A_2_ext_2_TU}.\ref{item:A_2_ext_2_vec_sign}.
        \item Holds, because columns of $[A_{2} \mid D]$ are in $[A_{2} \mid c_{0} \mid c_{1} \mid c_{2}]$, which is TU.
        \item Holds by Lemma~\ref{lem:A_2_ext_2_TU}.\ref{item:A_2_ext_2_TU}.
        % \item Holds by Lemma~\ref{lem:A_1_ext_2_TU}.\ref{item:A_1_ext_2_vec_sign}.
        \item Follows from Lemma~\ref{lem:A_1_ext_2_TU}.\ref{item:A_1_ext_2_TU}, as TUness is preserved by multiplying rows by $\pm 1$ factors (and changing row order).
        \item Holds, because rows of $[A_{1} / D]$ are in $[A_{1} / r_{0} / r_{1} / r_{2}]$, which is TU.
    \end{enumerate}
\end{proof}

\begin{definition}\label{def:alt_sum_constr}
    Let $A_{1} \in \mathbb{Q}^{X_{1} \cup Y_{1}}$, $A_{2} \in \mathbb{Q}^{X_{2} \cup Y_{2}}$, $c_{0}, c_{1} \in \mathbb{Q}^{X_{2}}$, $r_{0}, r_{1} \in \mathbb{Q}^{Y_{1}}$. Let $D = c_{0} \cdot r_{0} + c_{1} \cdot r_{1}$. Suppose that properties 2--7 from the statement of Lemma~\ref{lem:canonical_signing_properties} are satisfied for $A_{1}$, $A_{2}$, $c_{0}$, $c_{1}$, $r_{0}$, $r_{1}$.\todo{refactor} Given $k \in \mathbb{Z}_{\geq 1}$, define $\mathrm{Proposition}(A_{1}, A_{2}, c_{0}, c_{1}, r_{0}, r_{1}, k)$ to mean ``$C = \begin{NiceArray}{cc}[hvlines] A_{1} & 0 \\ D & A_{2} \\ \end{NiceArray}$ is $k$-TU".
\end{definition}

\begin{lemma}\label{lem:alt_1_TU}
    Assume the notation of Definition~\ref{def:alt_sum_constr}. Then $\mathrm{Proposition}(A_{1}, A_{2}, c_{0}, c_{1}, r_{0}, r_{1}, 1)$ holds.
\end{lemma}

\begin{proof}
    Every entry of $C$ is in one of four blocks: $0$, $A_{1}$, $D$, $A_{2}$. By the assumptions of Definition~\ref{def:alt_sum_constr}, all of these blocks are TU. Thus, $C$ is $1$-TU.
\end{proof}

\begin{lemma}\label{lem:alt_three_sum_pivot}
    Let $a \in \mathbb{Q}^{Y_{1}}$, $c_{0}, c_{1} \in \mathbb{Q}^{X_{2}}$, and $D \in \mathbb{Q}^{X_{2} \times Y_{1}}$. Suppose $[c_{0} \mid c_{1}]$ contains a canonical signing of $D_{0}^{(0)}$ as a submatrix.\todo{refactor} Suppose that columns of $D$ are in $[\pm c_{0} \mid \pm c_{1} \mid \pm (c_{0} - c_{1}) \mid 0]$ and that $T = [a / D]$ is TU. Suppose we pivot on entry $a_{j} \in \{\pm 1\}$ in $T$ and obtain matrix $T' = [a' \mid D']$. Then columns of $D'$ are in $[\pm c_{0} \mid \pm c_{1} \mid \pm (c_{0} - c_{1}) \mid 0]$.
\end{lemma}

\begin{proof}
    Perform an exhaustive case distinction on what pivot column $p$ in $T$ could be and what another column $q$ in $T$ could be. After pivoting, $T'$ must be TU. Every combination of $p$ and $q$ is either incompatible with TUness, or produces a column in $T'$ with the desired property (i.e., its restriction to $X_{2}$ is in $[\pm c_{0} \mid \pm c_{1} \mid \pm (c_{0} - c_{1}) \mid 0]$). This is tedious, but not difficult. \todo{need details?}
\end{proof}

\begin{lemma}\label{lem:alt_k_TU_induction}
    Assume the notation of Definition~\ref{def:alt_sum_constr}. Let $k \in \mathbb{Z}_{\geq 2}$. Suppose $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k - 1)$ holds for all $A_{1}'$, $r_{0}'$, and $r_{1}'$ satisfying the assumptions of Definition~\ref{def:alt_sum_constr}. Then $\mathrm{Proposition}(A_{1}, A_{2}, c_{0}, c_{1}, r_{0}, r_{1}, k)$ holds.
\end{lemma}

\begin{proof}
    Let $V$ be a $k \times k$ submatrix of $C$. For the sake of deriving a contradiction assume that $\det V \notin \{0, \pm 1\}$.

    Suppose that $V$ is a submatrix of $[A_{1} / D]$, $[A_{1} \mid 0]$, $[D \mid A_{2}]$, or $[0 / A_{2}]$. Since all of those four matrices are TU by the assumptions of Definition~\ref{def:alt_sum_constr}, we have $\det V \in \{0, \pm 1\}$. Thus, $V$ shares at least one row and one column index with $A_{1}$ and $A_{2}$ each.

    Consider the row index shared by $V$ and $A_{1}$. Note that this row in $V$ cannot consist of only $0$ entries, as otherwise $\det V = 0$. Thus, there exists a $\pm 1$ entry shared by $V$ and $A_{1}$. Let $i$ and $j$ denote the row and the column index of this entry, respectively.

    Perform a pivot in $C$ on the element $C (i, j)$. For every object, its modified counterpart after pivoting is denoted by the same symbol with a prime; for example, $B'$ denotes the entire matrix after the pivot. Note that the following statements hold.

    \begin{itemize}
        \item $C'$ contains a $(k - 1) \times (k - 1)$ submatrix $V'$ with $\det V' \notin \{0, \pm 1\}$. This holds by the same argument as for the $2$-sum: look at the submatrix $V'$ of $C'$ with the same row and column index sets as $V$ minus the pivot row $i$ and pivot column $j$.
        \item $C' = \begin{NiceArray}{cc}[hvlines] A_{1}' & 0 \\ D' & A_{2} \\ \end{NiceArray}$, i.e., the $0$ and the $A_{2}$ blocks remain unchanged. This holds by the same argument as for the $2$-sum: the pivot row is in the $0$ block.
        \item $[A_{1}' / D']$ is TU. This holds by the same argument as for the $2$-sum: TUness is preserved under pivoting.
        \item The columns of $D'$ are in $[0 \mid \pm c_{0} \mid \pm c_{1} \mid \pm (c_{0} - c_{1})]$. This holds by Lemma~\ref{lem:alt_three_sum_pivot}.
        \item There exist $r_{0}'$ and $r_{1}'$ such that $D' = c_{0} \cdot r_{0}' + c_{1} \cdot r_{1}'$ and the assumptions of Definition~\ref{def:alt_sum_constr} are satisfied for $A_{1}'$, $A_{2}$, $c_{0}$, $c_{1}$, $r_{0}'$, $r_{1}'$. This follows from the previous bullet point by carefully checking assumptions.\todo{need details?}
        \item $C'$ is $(k - 1)$-TU. This follows from the hypothesis: $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k - 1)$ holds.
    \end{itemize}

    To sum up, after pivoting we obtain a matrix $C'$ (which can be obtained in the manner of Definition~\ref{def:alt_sum_constr}) that is $(k - 1)$-TU and contains a $(k - 1) \times (k - 1)$ submatrix $V'$ with $\det V' \notin \{0, \pm 1\}$. This contradiction proves the lemma.
\end{proof}

\begin{lemma}\label{lem:three_sum_k_TU_induction}
    Let $B_{1}$ and $B_{2}$ be TU canonical signings. Let $k \in \mathbb{Z}_{\geq 1}$. Then the corresponding canonical signing $B$ is $k$-TU.
\end{lemma}

\begin{proof}
    Follows from Lemma~\ref{lem:alt_k_TU_induction}.\todo{need details?}
\end{proof}

\begin{lemma}\label{lem:three_sum_canonical_signing_TU}
    Let $B_{1}$ and $B_{2}$ be TU canonical signings. Then the corresponding canonical signing $B$ is TU.
\end{lemma}

\begin{proof}
    Define $A_{1}$, $A_{2}$, $c_{0}$, $c_{1}$, $r_{0}$, $r_{1}$ as in Lemma~\ref{lem:canonical_signing_properties}. Note that canonical signing $B$ has the form of $C$ in the notation of Definition~\ref{def:alt_sum_constr}.

    Proof by induction.

    Proposition for any $k \in \mathbb{Z}_{\geq 1}$: $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k)$ holds for all $A_{1}'$, $r_{0}'$, and $r_{1}'$ satisfying the assumptions of Definition~\ref{def:alt_sum_constr}.

    Base: The Proposition holds for $k = 1$ by Lemma~\ref{lem:alt_1_TU}.

    Step: If the Proposition holds for some $k$, then it also holds for $k + 1$ by Lemma~\ref{lem:alt_k_TU_induction}.

    Conclusion: $\mathrm{Proposition}(A_{1}', A_{2}, c_{0}, c_{1}, r_{0}', r_{1}', k)$ holds for all $k \in \mathbb{Z}_{\geq 1}$. In particular, canonical signing $B$ is $k$-TU for every $k \in \mathbb{Z}_{\geq 1}$. Thus, $B$ is TU.
\end{proof}

\begin{corollary}
    Suppose that $B_{1}^{(0)}$ and $B_{2}^{(0)}$ have TU signings. Then $B_{1} \oplus_{3} B_{2}$ has a TU signing.
\end{corollary}

\begin{proof}[Proof sketch.]
    Start with some TU signings, obtain canonical signings, apply Lemma~\ref{lem:three_sum_canonical_signing_TU}.
\end{proof}

\end{document}
